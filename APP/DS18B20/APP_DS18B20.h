/*!
================================================================================
@Project    : STM32_Standard_Wrapper_Libs  
@Module     : temperature sensor(DS18B20)
--------------------------------------------------------------------------------
@File Name	: APP_DS18B20.h                                                                                           
@Copyright by su.ch                                                    
--------------------------------------------------------------------------------
Change Records                                                              
--------------------------------------------------------------------------------
	[No]       [Name]       [Date]      [Description]                         
   1         su.ch        2022/01/06   first                                  
================================================================================
*/

#ifndef _APP_DS18B20_H
#define _APP_DS18B20_H

//!-----------------------------------------------------------------------------
//!------------------------------> For Debug <----------------------------------
//!-----------------------------------------------------------------------------

//!-----------------------------------------------------------------------------
//!------------------------------> Includes  <----------------------------------
//!-----------------------------------------------------------------------------
#include "BitBand.h"
#include "SysTick.h"
#include "DevWrapperIO.h"
#include <stdbool.h>

//!-----------------------------------------------------------------------------
//!-------------------------------> Constants   <-------------------------------
//!-----------------------------------------------------------------------------

//!-----------------------------------------------------------------------------
//!--------------------------------> Defines <----------------------------------
//!-----------------------------------------------------------------------------

// DS18B20-IO port
#define DS18B20_PORT GPIOG
#define DS18B20_PIN GPIO_Pin_11
#define DS18B20_PORT_RCC RCC_APB2Periph_GPIOG

#define DQ_IN PGin(11)

#define DQ_OUT_SET_H  (PGout(11) = 1)
#define DQ_OUT_SET_L  (PGout(11) = 0)

//!-----------------------------------------------------------------------------
//!-------------------------------> Structure   <-------------------------------
//!-----------------------------------------------------------------------------
typedef struct struct_DS
{
    IOProfile ctrlPin;
}DSProfile;

static DSProfile* m_pDS;

//!-----------------------------------------------------------------------------
//!------------------------------> Enumeration   <------------------------------
//!-----------------------------------------------------------------------------

//!-----------------------------------------------------------------------------
//!-------------------------> Function Declaration   <--------------------------
//!-----------------------------------------------------------------------------
bool Init(DSProfile*);
void Reset(void);
bool DetectDS(void);
void DSIOIn(void);
void DSIOOut(void);
void DSWriteByte(u8 wData);
u8 DSReadBit(void);
u8 DSReadByte(void);
float DSGetTempertare(void);

//namespace DS18B20Sensor
//{
//    class DS18B20Sensor
//		{
//		    public:
//				    DS18B20Sensor(DSProfile* pDS);
//				    virtual ~DS18B20Sensor(void);
//				
//				public:
//				    bool Init(void);
//				    void Reset(void);
//			      bool DetectDS(void);
//				    void DSIOIn(void);
//				    void DSIOOut(void);
//				    void DSWriteByte(u8 wData);
//				    u8 DSReadBit(void);
//				    u8 DSReadByte(void);
//				    float DSGetTempertare(void);
//				
//				private:
//				    
//				
//				protected:
//				    DSProfile* m_pDS;
//		};
//}


#endif
